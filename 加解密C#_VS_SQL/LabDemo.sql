USE [LabDemo]
GO

CREATE ASSEMBLY [UITC.Decipher]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103003B1FF9600000000000000000E00022200B013000000C00000006000000000000C62A0000002000000040000000000010002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000742A00004F00000000400000B802000000000000000000000000000000000000006000000C0000003C2900001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000CC0A000000200000000C000000020000000000000000000000000000200000602E72737263000000B80200000040000000040000000E0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001200000000000000000000000000004000004200000000000000000000000000000000A82A00000000000048000000020005009C220000A0060000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013300300810000000100001100280500000A72010000706F0600000A0A280500000A72230000706F0600000A0B72450000700C027245000070280700000A0D092C0E7245000070730800000A13042B3A0317FE01130511052C0B02060728030000060C2B1B0318FE01130611062C0B02060728020000060C2B0672470000700C08730800000A13042B0011042A0000001B300400AD000000020000110072450000700A140B00280900000A0B0720000100006F0A00000A000720000100006F0B00000A0002280C00000A0C730D00000A0D090703046F0E00000A17730F00000A130411040816088E696F1000000A0011046F1100000A0011046F1200000A00096F1300000A1305281400000A11056F1500000A130611060A00DE0C13070072470000701308DE1FDE18000714FE03130911092C0B00076F1600000A00140B0000DC0613082B0011082A000000011C000000000900767F000C0B00000102000900848D0018000000001B300400AD000000020000110072450000700A140B00280900000A0B0720000100006F0A00000A000720000100006F0B00000A00281400000A026F0600000A0C730D00000A0D090703046F1700000A17730F00000A130411040816088E696F1000000A0011046F1800000A0011046F1200000A00096F1300000A13051105281900000A130611060A00DE0C13070072470000701308DE1FDE18000714FE03130911092C0B00076F1600000A00140B0000DC0613082B0011082A000000011C000000000900767F000C0B00000102000900848D0018000000002202281A00000A002A00000042534A4201000100000000000C00000076342E302E33303331390000000005006C00000034020000237E0000A0020000D002000023537472696E677300000000700500005400000023555300C4050000100000002347554944000000D4050000CC00000023426C6F620000000000000002000001471502000900000000FA01330016000001000000120000000200000004000000080000001A0000000400000002000000010000000200000000005401010000000000060092001D020600B2001D02060069000A020F003D02000006007F0280010A007D00C9010A0018014C0206004B01A60206007301130006006601A6020600AB0180010600EF008E0206002501800106008701A60206008602800106009A01A60206007901130006003900A602000000000A000000000001000100010010006A0200001500010001005020000000009600C00186000100E020000000009600EA018D000300B821000000009600FA018D0006009022000000008618E4010600090000000100350000000200EA0000000100420100000200A202000003001D0000000100420100000200A202000003001D000900E40101001100E40106001900E4010A003100E401060061004A001D006100610222006900C30228003900E4012E0041005C0046007100DE0001007100D00001007900F8004B004900E40106007100EA0151005100E4015A0089006300640089002C01060089005600060049009A026C00610001001D006100220171007100B50106007100FA0151005100320106007900090177002900E401060020002300C7002E000B0096002E0013009F002E001B00BE0010003300048000000000000000000000000000000000BB0100000400000000000000000000007D002C00000000000400000000000000000000007D0020000000000000000000006765745F55544638003C4D6F64756C653E0053797374656D2E494F0049560053797374656D2E44617461006D73636F726C6962007372630043727970746F53747265616D4D6F6465006765745F556E69636F646500436C6F7365004372656174650057726974650044656275676761626C654174747269627574650053716C46756E6374696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465007365745F426C6F636B53697A65007365745F4B657953697A6500666C616700456E636F64696E670046726F6D426173653634537472696E6700546F426173653634537472696E670053716C537472696E6700476574537472696E6700466C75736800466C75736846696E616C426C6F636B006F726967696E616C0052696A6E6461656C00554954432E44656369706865722E646C6C0043727970746F53747265616D004D656D6F727953747265616D0053797374656D0053796D6D6574726963416C676F726974686D004943727970746F5472616E73666F726D00457863657074696F6E00436C65617200554954432E4465636970686572004D6963726F736F66742E53716C5365727665722E536572766572002E63746F7200437265617465446563727970746F7200437265617465456E63727970746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730053797374656D2E446174612E53716C54797065730047657442797465730055736572446566696E656446756E6374696F6E73004F626A65637400436F6E766572740053797374656D2E5465787400546F4172726179004B65790053797374656D2E53656375726974792E43727970746F677261706879006F705F457175616C697479000000216F80A690B27D1A904B006500790044006100740061002000200020002000200001216F80A690B27D1A904900560044006100740061002000200020002000200020000101000B4500720072006F00720000001A604FF3B20AED45966FB4CC8D44B108000420010108032000010520010111110C07071D051D050E02111D020204000012310520011D050E050002020E0E042001010E12070A0E12211D05122512291D050E122D0E0204000012210500011D050E08200212411D051D0509200301124512411149072003011D0508080420001D050520010E1D050500010E1D0508B77A5C561934E089060002111D0E080800030E0E1D051D050801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000000401000000000000003B1FF96000000000020000001C01000058290000580B000052534453B2ABAFF106267F45ACB15FF81D96998001000000433A5C55736572735C736861776E6C696E5C736F757263655C7265706F735C4461746162617365315C4461746162617365315C6F626A5C44656275675C554954432E44656369706865722E70646200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009C2A00000000000000000000B62A0000002000000000000000000000000000000000000000000000A82A0000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000584000005C02000000000000000000005C0234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004BC010000010053007400720069006E006700460069006C00650049006E0066006F0000009801000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E003000000044001200010049006E007400650072006E0061006C004E0061006D006500000055004900540043002E00440065006300690070006800650072002E0064006C006C0000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000004C00120001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000055004900540043002E00440065006300690070006800650072002E0064006C006C000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C000000C83A00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = SAFE
GO


CREATE FUNCTION [dbo].[Decipher](@src [nvarchar](1000), @flag [int])
RETURNS [nvarchar](1000) WITH EXECUTE AS CALLER
AS 
EXTERNAL NAME [UITC.Decipher].[UserDefinedFunctions].[Decipher]
GO

SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO

CREATE TABLE LabDemo.dbo.TestDecrypt (
    id INT PRIMARY KEY,
    name VARCHAR(100),
	tw_id VARCHAR(100)
)


DECLARE @i INT = 1;
WHILE @i <= 1000
BEGIN
    INSERT INTO LabDemo.dbo.TestDecrypt (id, name,tw_id) VALUES (@i, [dbo].[Decipher]('¾÷¾¹¤H',1),[dbo].[Decipher]('F123456789',1));
    SET @i = @i + 1;
END;